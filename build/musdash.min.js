/*!
 * musdash.js - Stupidly quick logic-less {{mustache}} templates for JavaScript
 * Some code borrowed from: http://github.com/janl/mustache.js
 */
var Musdash=(typeof module!=="undefined"&&module.exports)||{};(function(c){c.name="musdash.js";c.version="0.1.3-dev";c.compile=g;c.options=i;var b=/&(?!\w+;)|[<>"']/g;var d={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};var a={open:"{{",close:"}}"};function i(k){for(var j in k){this.opts[j]=k[j]}}function e(l,k,j){this.code=l;this.name=k;this.inverted=j;this.parse=function(m){return this._render([m])};this._dorender=function(q){var p=true;var n=1;var m=this.code.length;var o=this.code[0];for(;n<m;n++){if(p){if(this.code[n]!==null){o+=this.code[n]._render(q)}}else{o+=this.code[n]}p=!p}return o};this._render=function(m){var n;var q=m[0];if(this.name!==null){for(n=0,len=m.length;n<len;n++){if(m[n][this.name]!==undefined){q=m[n][this.name];break}}}if(typeof q=="function"){return q.apply(m[0],[this._dorender(m)])}else{if(q instanceof Array){var o="";var p=q.length;if(p===0){if(!this.inverted){return""}return this._dorender(m)}else{if(this.inverted){return""}for(n=0;n<p;n++){m.unshift(q[n]);m[0]._i=n+1;m[0]._c=p;o+=this._dorender(m);m.shift()}}return o}else{if(this.name!==null){m.unshift(q)}return this._dorender(m)}}}}function f(j,k){this.name=j;this.escape=k;this._render=function(l){var m=this._findSymbol(l,this.name);if(m===null){return""}if(typeof m=="function"){return m.apply(l[0],[])}else{return this.escape?h(m):m}};this._findSymbol=function(n,q){if(q=="."){return n[0]}if(n[0][q]!==undefined){return n[0][q]}var r=q.split(".");var s=r.length;for(var o=0,m=n.length;o<m;o++){var p=n[o];for(var l=0;l<s;l++){p=p[r[l]];if(p===undefined){break}}if(p!==undefined){return p}}return null}}function h(j){return new String(j).replace(b,function(k){return d[k]||k})}function g(o){var p=o.split(a.open);var k=p.length;var j=1;var m=1;var n={code:[p[0]],parent:null,name:null,inverted:false};for(;j<k;j++){tmp=p[j].split(a.close);part1=tmp[0];part2=tmp[1];if(part1[0]=="#"){n={code:[],parent:n,name:part1.substring(1),inverted:false}}else{if(part1[0]=="^"){n={code:[],parent:n,name:part1.substring(1),inverted:true}}else{if(part1[0]=="/"){if("/"+n.name!=part1){throw new Error("Expecting `/"+n.name+"` not `"+part1+"`")}n.parent.code.push(new e(n.code,n.name,n.inverted));n=n.parent}else{if(part1[0]=="!"){n.code.push(null)}else{if(part1[0]=="&"){n.code.push(new f(part1.substring(1),false))}else{n.code.push(new f(part1,true))}}}}}n.code.push(part2)}if(n.parent!==null){throw new Error("`"+n.name+"` was left open")}return new e(n.code,null,null)}})(Musdash);